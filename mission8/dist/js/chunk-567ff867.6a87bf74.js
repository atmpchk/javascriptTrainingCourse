(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-567ff867"],{"13d5":function(t,o,a){"use strict";var e=a("23e7"),n=a("d58f").left,i=a("a640"),r=a("ae40"),s=i("reduce"),c=r("reduce",{1:0});e({target:"Array",proto:!0,forced:!s||!c},{reduce:function(t){return n(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"48af":function(t,o,a){"use strict";a.r(o);var e=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("div",{staticClass:"container",attrs:{id:"cart"}},[a("loading",{attrs:{active:t.isLoading,"is-full-page":t.isFullPageLoading},on:{"update:active":function(o){t.isLoading=o}}}),a("div",{staticClass:"container mb-5"},[a("div",{staticClass:"mt-3"},[a("h3",{staticClass:"mt-3 mb-4"},[t._v("購物清單")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-8"},[a("table",{staticClass:"table"},[t._m(0),a("tbody",t._l(t.cart,(function(o,e){return a("tr",{key:o.product.id,staticClass:"border-bottom",class:{"border-top":0===e}},[a("th",{staticClass:"border-0 px-0 font-weight-normal py-4",attrs:{scope:"row"}},[a("img",{staticStyle:{width:"72px",height:"72px","object-fit":"cover"},attrs:{src:o.product.imageUrl[0],alt:""}}),a("p",{staticClass:"mb-0 font-weight-bold ml-3 d-inline-block"},[t._v(" "+t._s(o.product.title)+" ")])]),a("td",{staticClass:"border-0 align-middle",staticStyle:{"max-width":"160px"}},[a("div",{staticClass:"input-group pr-5"},[a("div",{staticClass:"input-group-prepend"},[a("button",{staticClass:"btn btn-outline-dark border-0 py-2",attrs:{type:"button",id:"button-addon1"},on:{click:function(a){return t.minusItemQuantity(o)}}},[a("i",{staticClass:"fas fa-minus"})])]),a("input",{directives:[{name:"model",rawName:"v-model",value:o.quantity,expression:"item.quantity"}],staticClass:"form-control border-0 text-center my-auto shadow-none bg-white",attrs:{type:"text",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",readonly:""},domProps:{value:o.quantity},on:{input:function(a){a.target.composing||t.$set(o,"quantity",a.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-dark border-0 py-2",attrs:{type:"button",id:"button-addon2"},on:{click:function(a){return t.addItemQuantity(o)}}},[a("i",{staticClass:"fas fa-plus"})])])])]),a("td",{staticClass:"border-0 align-middle"},[a("p",{staticClass:"mb-0 ml-auto"},[t._v(" "+t._s(t._f("formatCurrency")(o.product.price))+" ")])]),a("td",{staticClass:"border-0 align-middle"},[a("a",{attrs:{href:"#"},on:{click:function(a){return t.deleteItem(o)}}},[a("i",{staticClass:"fas fa-times"})])])])})),0)]),a("div",{staticClass:"input-group w-50"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control rounded-0\n                border-bottom border-top-0 border-left-0 border-right-0 shadow-none",attrs:{type:"text",placeholder:"折扣代碼","aria-label":"Coupon Code","aria-describedby":"button-addon2"},domProps:{value:t.couponCode},on:{input:[function(o){o.target.composing||(t.couponCode=o.target.value)},t.resetCouponData]}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-dark\n                  border-bottom border-top-0 border-left-0 border-right-0 rounded-0",attrs:{type:"button",id:"button-addon2"},on:{click:t.searchCoupon}},[a("i",{staticClass:"fas fa-paper-plane"})])])]),a("div",[this.couponFailMsg?a("div",{staticClass:"text-muted"},[t._v(t._s(t.couponFailMsg))]):t._e()])]),a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"border p-4 mb-4"},[a("h4",{staticClass:"font-weight-bold mb-4"},[t._v("訂單試算")]),a("table",{staticClass:"table text-muted border-bottom"},[a("tbody",[a("tr",[a("th",{staticClass:"border-0 px-0 pt-4 font-weight-normal",attrs:{scope:"row"}},[t._v("小計")]),a("td",{staticClass:"text-right border-0 px-0 pt-4"},[t._v(" "+t._s(t._f("formatCurrency")(t.priceSummary))+" ")])]),t.couponInfo?a("tr",[a("th",{staticClass:"border-0 px-0 pt-0 pb-2 font-weight-normal",attrs:{scope:"row"}},[t._v(" "+t._s(t.couponInfo.title)+" ")]),a("td",{staticClass:"text-right text-danger border-0 px-0 pt-0 pb-2"},[t._v(" "+t._s("- ")+t._s(t._f("formatCurrency")(t.discountedBy))+" ")])]):t._e(),a("tr",[a("th",{staticClass:"border-0 px-0 pt-0 pb-4 font-weight-normal align-middle",attrs:{scope:"row"}},[t._v(" 付款方式 ")]),a("td",{staticClass:"text-right border-0 px-0 pt-0 pb-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.payment,expression:"payment"}],staticClass:"text-right form-control rounded-0 my-auto shadow-none bg-white",attrs:{id:"payment"},on:{change:[function(o){var a=Array.prototype.filter.call(o.target.options,(function(t){return t.selected})).map((function(t){var o="_value"in t?t._value:t.value;return o}));t.payment=o.target.multiple?a:a[0]},t.updatePayment]}},t._l(t.paymentMethods,(function(o){return a("option",{key:o,domProps:{value:o}},[t._v(" "+t._s(o)+" ")])})),0)])])])]),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v("總計")]),a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v(t._s(t._f("formatCurrency")(t.totalPrice)))])]),a("router-link",{staticClass:"btn btn-dark btn-block mt-4",attrs:{to:"/checkOut"+t.discountPath}},[t._v(" 訂單確定 ")])],1)])])])])],1)},n=[function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("thead",[a("tr",[a("th",{staticClass:"border-0 pl-0",attrs:{scope:"col"}},[t._v("美味")]),a("th",{staticClass:"border-0",attrs:{scope:"col"}},[t._v("數量")]),a("th",{staticClass:"border-0",attrs:{scope:"col"}},[t._v("單價")]),a("th",{staticClass:"border-0",attrs:{scope:"col"}})])])}],i=(a("99af"),a("13d5"),a("ac1f"),a("5319"),a("498a"),{data:function(){return{apiInfo:{forCouponSearch:"/ec/coupon/search",forCart:"/ec/shopping"},cart:[],isLoading:!1,isFullPageLoading:!0,pagination:{},paymentMethods:["WebATM","ATM","CVS","Barcode","Credit","ApplePay","GooglePay"],payment:"Credit",payemntExpired:2592e6,couponCode:"",couponInfo:null,couponFailMsg:""}},computed:{priceSummary:function(){return this.cart.reduce((function(t,o){return t+o.product.price*o.quantity}),0)},discountedBy:function(){return this.couponInfo?this.priceSummary*((100-this.couponInfo.percent)/100):0},totalPrice:function(){return this.priceSummary-this.discountedBy},discountPath:function(){return this.couponInfo?"/".concat(this.couponInfo.code):""}},created:function(){var t=document.cookie.replace(/(?:(?:^|.*;\s*)hexSchoolPayment\s*=\s*([^;]*).*$)|^.*$/,"$1");t&&(this.payment=t)},mounted:function(){this.getCart()},methods:{givePage:function(t){return t||(this.pagination.current_page||1)},getCart:function(t){var o=this;this.isLoading=!0,this.axios.get("".concat(this.apiInfo.forCart,"?page=").concat(this.givePage(t))).then((function(t){o.cart=t.data.data,o.pagination=t.data.meta.pagination,0===o.cart.length&&o.$router.replace("/"),o.isLoading=!1})).catch((function(t){o.isLoading=!1,console.log(t)}))},addItemQuantity:function(t){return t.quantity<10&&this.editItemQuantity(t,1)},minusItemQuantity:function(t){return t.quantity>1&&this.editItemQuantity(t,-1)},editItemQuantity:function(t,o){var a=this;this.isLoading=!0,this.axios.patch(this.apiInfo.forCart,{product:t.product.id,quantity:t.quantity+o}).then((function(){a.$bus.$emit("addProductToCart",{id:t.product.id,quantity:o}),a.isLoading=!1,a.getCart()})).catch((function(t){a.isLoading=!1,console.log(t)}))},deleteItem:function(t){var o=this;this.isLoading=!0,this.axios.delete("".concat(this.apiInfo.forCart,"/").concat(t.product.id)).then((function(){o.isLoading=!1,o.$bus.$emit("removeProductFromCart",t.product.id),o.getCart()})).catch((function(t){o.isLoading=!1,console.log(t)}))},setLoading:function(t){this.isLoading=t},updatePayment:function(){document.cookie="hexSchoolPayment=".concat(this.payment,";expires=").concat(new Date(Date.now()+this.payemntExpired),"; path=/")},resetCouponData:function(){this.couponInfo=null,this.couponFailMsg=""},searchCoupon:function(){var t=this;""!==this.couponCode.trim()?(this.isLoading=!0,this.axios.post(this.apiInfo.forCouponSearch,{code:this.couponCode}).then((function(o){t.couponInfo=o.data.data,t.isLoading=!1})).catch((function(o){t.couponFailMsg="無效或不存在的折扣代碼",t.isLoading=!1,console.log(o)}))):this.couponCode=""}}}),r=i,s=a("2877"),c=Object(s["a"])(r,e,n,!1,null,null,null);o["default"]=c.exports},"498a":function(t,o,a){"use strict";var e=a("23e7"),n=a("58a8").trim,i=a("c8d2");e({target:"String",proto:!0,forced:i("trim")},{trim:function(){return n(this)}})},5899:function(t,o){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,o,a){var e=a("1d80"),n=a("5899"),i="["+n+"]",r=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),c=function(t){return function(o){var a=String(e(o));return 1&t&&(a=a.replace(r,"")),2&t&&(a=a.replace(s,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},c8d2:function(t,o,a){var e=a("d039"),n=a("5899"),i="​᠎";t.exports=function(t){return e((function(){return!!n[t]()||i[t]()!=i||n[t].name!==t}))}},d58f:function(t,o,a){var e=a("1c0b"),n=a("7b0b"),i=a("44ad"),r=a("50c4"),s=function(t){return function(o,a,s,c){e(a);var u=n(o),d=i(u),l=r(u.length),p=t?l-1:0,f=t?-1:1;if(s<2)while(1){if(p in d){c=d[p],p+=f;break}if(p+=f,t?p<0:l<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:l>p;p+=f)p in d&&(c=a(c,d[p],p,u));return c}};t.exports={left:s(!1),right:s(!0)}}}]);
//# sourceMappingURL=chunk-567ff867.6a87bf74.js.map